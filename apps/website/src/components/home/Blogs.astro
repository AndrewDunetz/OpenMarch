---
import { getCollection, type CollectionEntry } from "astro:content";
import { Image } from "astro:assets";

const blogs = await getCollection("blog");
type Blog = CollectionEntry<"blog">;
---

<section id="blogs" class="flex flex-col gap-16">
    <div class="flex justify-between">
        <h1 class="text-h1">Blog</h1>
        <a href="/blog">See all posts</a>
    </div>
    <div
        class="grid grid-cols-3 gap-24 max-[1200px]:grid-cols-2 max-[850px]:grid-cols-1"
    >
        {
            blogs
                .sort(
                    (a, b) =>
                        new Date(b.data.date).getTime() -
                        new Date(a.data.date).getTime(),
                )
                .slice(0, 3)
                .map((blog: Blog) => (
                    <a
                        href={`/blog/${blog.id}`}
                        class="flex flex-col gap-16 rounded-6 border border-stroke bg-fg-1 p-32 duration-150 ease-out hover:border-accent"
                    >
                        <Image
                            src={blog.data.image}
                            width={670}
                            height={420}
                            alt={blog.data.title}
                            class="aspect-video h-auto w-full rounded-6 border border-stroke object-cover"
                        />
                        <div class="flex w-full flex-col gap-16">
                            <h2 class="w-full text-h2">{blog.data.title}</h2>
                            <p class="w-full text-body leading-[150%]">
                                by {blog.data.author}
                            </p>
                            <p class="w-full text-body leading-[150%]">
                                {blog.data.date.toLocaleDateString("en-US", {
                                    year: "numeric",
                                    month: "long",
                                    day: "numeric",
                                    timeZone: "UTC",
                                })}
                            </p>
                        </div>
                    </a>
                ))
        }
    </div>
</section>
